{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\WorkPlace-React\\\\MERNAPP\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\WorkPlace-React\\\\MERNAPP\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\WorkPlace-React\\\\MERNAPP\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\WorkPlace-React\\\\MERNAPP\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"E:\\\\WorkPlace-React\\\\MERNAPP\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"E:\\\\WorkPlace-React\\\\MERNAPP\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"E:\\\\WorkPlace-React\\\\MERNAPP\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import Category from'./Category';import Content from'./Content';import Spinner from'react-spinner-material';import'./Home.css';var Home=/*#__PURE__*/function(_React$Component){_inherits(Home,_React$Component);function Home(props){var _this;_classCallCheck(this,Home);_this=_possibleConstructorReturn(this,_getPrototypeOf(Home).call(this,props));_this.onChoose=function(maloaihang){_this.setState({chooseID:maloaihang});};_this.changeCurrentPage=function(numPage){_this.setState({currentPage:numPage});};_this.doSearch=function(e){var products=_this.state.products;products=products.filter(function(p){return p.TEN_SAN_PHAM.includes(e.target.value);});_this.setState({searchResults:products,totals:products.length});};_this.state={category:[],chooseID:'LH001',products:[],searchResults:[],totals:0,currentPage:1,isLoading:false};_this.myRef=React.createRef();return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,category,response_1,products,response_2,totals;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('did mount');this.setState({isLoading:true});_context.next=4;return fetch('/api/category');case 4:response=_context.sent;_context.next=7;return response.json();case 7:category=_context.sent;_context.next=10;return fetch(\"/api/producttype/\".concat(this.state.chooseID,\"/1\"));case 10:response_1=_context.sent;_context.next=13;return response_1.json();case 13:products=_context.sent;_context.next=16;return fetch(\"/api/totalproduct/\".concat(this.state.chooseID));case 16:response_2=_context.sent;_context.next=19;return response_2.json();case 19:totals=_context.sent;this.setState({category:category,products:products,searchResults:products,totals:totals,isLoading:false});case 21:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentDidUpdate\",value:function(){var _componentDidUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(prevProps,prevState){var currentPage,response_1,products,chooseID,response_2,totals;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:currentPage=this.state.currentPage;console.log(prevState);console.log(this.state.currentPage);if(!(currentPage!=prevState.currentPage)){_context2.next=12;break;}this.setState({isLoading:true});_context2.next=7;return fetch(\"/api/producttype/\".concat(this.state.chooseID,\"/\").concat(currentPage));case 7:response_1=_context2.sent;_context2.next=10;return response_1.json();case 10:products=_context2.sent;this.setState({products:products,searchResults:products,isLoading:false});case 12:chooseID=this.state.chooseID;if(!(chooseID!=prevState.chooseID)){_context2.next=28;break;}this.setState({isLoading:true});_context2.next=17;return fetch(\"/api/producttype/\".concat(this.state.chooseID,\"/1\"));case 17:response_1=_context2.sent;_context2.next=20;return response_1.json();case 20:products=_context2.sent;_context2.next=23;return fetch(\"/api/totalproduct/\".concat(this.state.chooseID));case 23:response_2=_context2.sent;_context2.next=26;return response_2.json();case 26:totals=_context2.sent;this.setState({products:products,searchResults:products,totals:totals,currentPage:1,isLoading:false});case 28:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidUpdate(_x,_x2){return _componentDidUpdate.apply(this,arguments);}return componentDidUpdate;}()},{key:\"render\",value:function render(){console.log('home render');return this.state.isLoading?React.createElement(\"div\",{className:\"loading\"},React.createElement(Spinner,{size:120,spinnerColor:\"#333\",spinnerWidth:3,visible:this.state.loading})):React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"row1 body input\"},React.createElement(\"div\",{style:{width:'100%'}}),React.createElement(\"div\",{className:\"search\"},React.createElement(\"input\",{ref:this.myRef,placeholder:\"Search...\",className:\"input\",onChange:this.doSearch}))),React.createElement(\"div\",{className:\"row1 body\"},React.createElement(Category,{category:this.state.category,isActive:this.state.chooseID,onChoose:this.onChoose}),React.createElement(Content,{chooseID:this.state.chooseID,products:this.state.searchResults,totals:this.state.totals,currentPage:this.state.currentPage,changeCurrentPage:this.changeCurrentPage})));}}]);return Home;}(React.Component);export default Home;","map":{"version":3,"sources":["E:/WorkPlace-React/MERNAPP/client/src/Home/Home.js"],"names":["React","Category","Content","Spinner","Home","props","onChoose","maloaihang","setState","chooseID","changeCurrentPage","numPage","currentPage","doSearch","e","products","state","filter","p","TEN_SAN_PHAM","includes","target","value","searchResults","totals","length","category","isLoading","myRef","createRef","console","log","fetch","response","json","response_1","response_2","prevProps","prevState","loading","width","Component"],"mappings":"2mCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,OAAP,KAAoB,wBAApB,CACA,MAAO,YAAP,C,GACMC,CAAAA,I,0EACF,cAAYC,KAAZ,CAAmB,sCACf,sEAAMA,KAAN,GADe,MAmCnBC,QAnCmB,CAmCR,SAACC,UAAD,CAAgB,CACvB,MAAKC,QAAL,CAAc,CACVC,QAAQ,CAAEF,UADA,CAAd,EAGH,CAvCkB,OAyCnBG,iBAzCmB,CAyCC,SAACC,OAAD,CAAa,CAC7B,MAAKH,QAAL,CAAc,CAACI,WAAW,CAAED,OAAd,CAAd,EACH,CA3CkB,OA6CnBE,QA7CmB,CA6CR,SAACC,CAAD,CAAO,IACTC,CAAAA,QADS,CACG,MAAKC,KADR,CACTD,QADS,CAEdA,QAAQ,CAAGA,QAAQ,CAACE,MAAT,CAAgB,SAAAC,CAAC,CAAI,CAC5B,MAAOA,CAAAA,CAAC,CAACC,YAAF,CAAeC,QAAf,CAAwBN,CAAC,CAACO,MAAF,CAASC,KAAjC,CAAP,CACH,CAFU,CAAX,CAGA,MAAKd,QAAL,CAAc,CACVe,aAAa,CAAER,QADL,CAEVS,MAAM,CAAET,QAAQ,CAACU,MAFP,CAAd,EAIH,CAtDkB,CAEf,MAAKT,KAAL,CAAa,CACTU,QAAQ,CAAE,EADD,CAETjB,QAAQ,CAAE,OAFD,CAGTM,QAAQ,CAAE,EAHD,CAITQ,aAAa,CAAE,EAJN,CAKTC,MAAM,CAAE,CALC,CAMTZ,WAAW,CAAE,CANJ,CAOTe,SAAS,CAAE,KAPF,CAAb,CASA,MAAKC,KAAL,CAAa5B,KAAK,CAAC6B,SAAN,EAAb,CAXe,aAYlB,C,2UAGGC,OAAO,CAACC,GAAR,CAAY,WAAZ,EACA,KAAKvB,QAAL,CAAc,CAACmB,SAAS,CAAE,IAAZ,CAAd,E,sBACqBK,CAAAA,KAAK,CAAC,eAAD,C,QAAtBC,Q,qCACiBA,CAAAA,QAAQ,CAACC,IAAT,E,QAAjBR,Q,sCAEmBM,CAAAA,KAAK,4BAAqB,KAAKhB,KAAL,CAAWP,QAAhC,O,SAAxB0B,U,sCACiBA,CAAAA,UAAU,CAACD,IAAX,E,SAAjBnB,Q,sCAEmBiB,CAAAA,KAAK,6BAAsB,KAAKhB,KAAL,CAAWP,QAAjC,E,SAAxB2B,U,sCACeA,CAAAA,UAAU,CAACF,IAAX,E,SAAfV,M,eAEJ,KAAKhB,QAAL,CAAc,CACVkB,QAAQ,CAAEA,QADA,CAEVX,QAAQ,CAAEA,QAFA,CAGVQ,aAAa,CAAER,QAHL,CAIVS,MAAM,CAAEA,MAJE,CAKVG,SAAS,CAAE,KALD,CAAd,E,wTA8BqBU,S,CAAWC,S,qLAC3B1B,W,CAAe,KAAKI,K,CAApBJ,W,CACLkB,OAAO,CAACC,GAAR,CAAYO,SAAZ,EACAR,OAAO,CAACC,GAAR,CAAY,KAAKf,KAAL,CAAWJ,WAAvB,E,KACGA,WAAW,EAAI0B,SAAS,CAAC1B,W,4BACxB,KAAKJ,QAAL,CAAc,CAACmB,SAAS,CAAE,IAAZ,CAAd,E,uBACuBK,CAAAA,KAAK,4BAAqB,KAAKhB,KAAL,CAAWP,QAAhC,aAA4CG,WAA5C,E,QAAxBuB,U,wCACiBA,CAAAA,UAAU,CAACD,IAAX,E,SAAjBnB,Q,gBAEJ,KAAKP,QAAL,CAAc,CAACO,QAAQ,CAAEA,QAAX,CAAqBQ,aAAa,CAAER,QAApC,CAA8CY,SAAS,CAAE,KAAzD,CAAd,E,QAGClB,Q,CAAY,KAAKO,K,CAAjBP,Q,MACFA,QAAQ,EAAI6B,SAAS,CAAC7B,Q,4BACrB,KAAKD,QAAL,CAAc,CAACmB,SAAS,CAAE,IAAZ,CAAd,E,wBACuBK,CAAAA,KAAK,4BAAqB,KAAKhB,KAAL,CAAWP,QAAhC,O,SAAxB0B,U,wCACiBA,CAAAA,UAAU,CAACD,IAAX,E,SAAjBnB,Q,wCAEmBiB,CAAAA,KAAK,6BAAsB,KAAKhB,KAAL,CAAWP,QAAjC,E,SAAxB2B,U,wCACeA,CAAAA,UAAU,CAACF,IAAX,E,SAAfV,M,gBAEJ,KAAKhB,QAAL,CAAc,CACVO,QAAQ,CAAEA,QADA,CAEVQ,aAAa,CAAER,QAFL,CAGVS,MAAM,CAAEA,MAHE,CAIVZ,WAAW,CAAE,CAJH,CAKVe,SAAS,CAAE,KALD,CAAd,E,2NAUA,CACJG,OAAO,CAACC,GAAR,CAAY,aAAZ,EACA,MACI,MAAKf,KAAL,CAAWW,SAAX,CACA,2BAAK,SAAS,CAAC,SAAf,EACI,oBAAC,OAAD,EAAS,IAAI,CAAE,GAAf,CAAoB,YAAY,CAAE,MAAlC,CAA0C,YAAY,CAAE,CAAxD,CAA2D,OAAO,CAAE,KAAKX,KAAL,CAAWuB,OAA/E,EADJ,CADA,CAKA,wCACA,2BAAK,SAAS,CAAC,iBAAf,EACI,2BAAK,KAAK,CAAE,CAACC,KAAK,CAAE,MAAR,CAAZ,EADJ,CAEI,2BAAK,SAAS,CAAC,QAAf,EACA,6BAAO,GAAG,CAAE,KAAKZ,KAAjB,CAAwB,WAAW,CAAC,WAApC,CAAgD,SAAS,CAAC,OAA1D,CAAkE,QAAQ,CAAE,KAAKf,QAAjF,EADA,CAFJ,CADA,CAOA,2BAAK,SAAS,CAAC,WAAf,EACI,oBAAC,QAAD,EAAU,QAAQ,CAAE,KAAKG,KAAL,CAAWU,QAA/B,CAAyC,QAAQ,CAAE,KAAKV,KAAL,CAAWP,QAA9D,CAAwE,QAAQ,CAAE,KAAKH,QAAvF,EADJ,CAEI,oBAAC,OAAD,EAAS,QAAQ,CAAE,KAAKU,KAAL,CAAWP,QAA9B,CAAwC,QAAQ,CAAE,KAAKO,KAAL,CAAWO,aAA7D,CAA4E,MAAM,CAAE,KAAKP,KAAL,CAAWQ,MAA/F,CAAuG,WAAW,CAAE,KAAKR,KAAL,CAAWJ,WAA/H,CAA4I,iBAAiB,CAAE,KAAKF,iBAApK,EAFJ,CAPA,CANJ,CAmBH,C,kBA7GcV,KAAK,CAACyC,S,EAgHzB,cAAerC,CAAAA,IAAf","sourcesContent":["import React from 'react';\r\nimport Category from './Category';\r\nimport Content from './Content';\r\nimport Spinner from 'react-spinner-material';   \r\nimport './Home.css';\r\nclass Home extends React.Component{\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            category: [],\r\n            chooseID: 'LH001',\r\n            products: [],\r\n            searchResults: [],\r\n            totals: 0,\r\n            currentPage: 1,\r\n            isLoading: false\r\n        }\r\n        this.myRef = React.createRef();\r\n    }\r\n\r\n    async componentDidMount(){\r\n        console.log('did mount')\r\n        this.setState({isLoading: true})\r\n        var response = await fetch('/api/category');\r\n        var category = await response.json();\r\n\r\n        var response_1 = await fetch(`/api/producttype/${this.state.chooseID}/1`);\r\n        var products = await response_1.json();\r\n\r\n        var response_2 = await fetch(`/api/totalproduct/${this.state.chooseID}`);\r\n        var totals = await response_2.json();\r\n\r\n        this.setState({\r\n            category: category,\r\n            products: products,\r\n            searchResults: products,\r\n            totals: totals,\r\n            isLoading: false\r\n        })\r\n    }\r\n\r\n    onChoose = (maloaihang) => {\r\n        this.setState({\r\n            chooseID: maloaihang\r\n        })\r\n    }\r\n\r\n    changeCurrentPage = (numPage) => {\r\n        this.setState({currentPage: numPage})\r\n    }\r\n\r\n    doSearch = (e) => {\r\n        var {products} = this.state;\r\n        products = products.filter(p => {\r\n            return p.TEN_SAN_PHAM.includes(e.target.value);\r\n        })\r\n        this.setState({\r\n            searchResults: products,\r\n            totals: products.length\r\n        })\r\n    }\r\n\r\n    async componentDidUpdate(prevProps, prevState){\r\n        var {currentPage} = this.state;\r\n        console.log(prevState)\r\n        console.log(this.state.currentPage)\r\n        if(currentPage != prevState.currentPage){\r\n            this.setState({isLoading: true});\r\n            var response_1 = await fetch(`/api/producttype/${this.state.chooseID}/${currentPage}`);\r\n            var products = await response_1.json();\r\n\r\n            this.setState({products: products, searchResults: products, isLoading: false});\r\n        }\r\n\r\n        var {chooseID} = this.state;\r\n        if(chooseID != prevState.chooseID){\r\n            this.setState({isLoading: true});\r\n            var response_1 = await fetch(`/api/producttype/${this.state.chooseID}/1`);\r\n            var products = await response_1.json();\r\n            \r\n            var response_2 = await fetch(`/api/totalproduct/${this.state.chooseID}`);\r\n            var totals = await response_2.json();\r\n            \r\n            this.setState({\r\n                products: products,\r\n                searchResults: products,\r\n                totals: totals,\r\n                currentPage: 1,\r\n                isLoading: false\r\n            });\r\n        }\r\n    }\r\n\r\n    render(){\r\n        console.log('home render')\r\n        return(\r\n            this.state.isLoading ?\r\n            <div className=\"loading\"> \r\n                <Spinner size={120} spinnerColor={\"#333\"} spinnerWidth={3} visible={this.state.loading} />\r\n            </div>\r\n            :\r\n            <>\r\n            <div className=\"row1 body input\">\r\n                <div style={{width: '100%'}}></div>\r\n                <div className=\"search\">\r\n                <input ref={this.myRef} placeholder=\"Search...\" className=\"input\" onChange={this.doSearch}></input>\r\n                </div>\r\n            </div>\r\n            <div className=\"row1 body\">\r\n                <Category category={this.state.category} isActive={this.state.chooseID} onChoose={this.onChoose} />\r\n                <Content chooseID={this.state.chooseID} products={this.state.searchResults} totals={this.state.totals} currentPage={this.state.currentPage} changeCurrentPage={this.changeCurrentPage}/>\r\n            </div>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Home;"]},"metadata":{},"sourceType":"module"}